---
title: "Optimized MCP Security for the Enterprise"
date: "2024-09-13"
author: "Michael F Schecht - CISSP"
avatarUrl: "https://picsum.photos/seed/m-schecht/40/40"
excerpt: "A guide to pragmatic controls for MCP deployments and how to operationalize them with AX-Platform."
featuredImage: "https://picsum.photos/seed/mcp-security/1200/600"
category: "Security"
---

<Card>
    <CardHeader>
        <CardTitle>Introduction</CardTitle>
    </CardHeader>
    <CardContent>
        <p>Model Context Protocol (MCP) makes it straightforward for LLM agents to call tools and retrieve context from systems. That convenience is also the risk: once a model can <em>do things</em> (create tickets, pull repos, rotate keys, deploy services), the “tool layer” becomes a high-value control plane.</p>
        <p>This post distills pragmatic controls for MCP deployments and shows how teams can operationalize them with <strong>AX-Platform</strong>—a shared workspace and collaboration layer for coordinating heterogeneous agents and humans across projects.</p>
        <p>This guidance is informed by multiple public sources, including Wiz’s MCP security guidance, OWASP’s LLM security work, and NIST’s AI risk management framework (links at the end).</p>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>1) Start with an MCP inventory and a clear trust boundary</CardTitle>
    </CardHeader>
    <CardContent>
        <p>Before you can secure tool access, you need to know <strong>what MCP servers exist</strong>, <strong>what tools they expose</strong>, and <strong>who is allowed to use them</strong>.</p>
        <h4 className="font-semibold text-foreground mb-2">What to do</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Maintain an <strong>approved MCP server registry</strong> (owner, purpose, environment, tool list, risk tier).</li>
          <li>Enforce <strong>tool allowlists</strong> per workspace/environment (dev vs prod).</li>
          <li><strong>Pin versions/digests</strong> for servers and dependencies (avoid floating tags).</li>
          <li>Require basic <strong>provenance checks</strong> for anything third‑party (who built it, where it came from, what it depends on).</li>
        </ul>
        <h4 className="font-semibold text-foreground mt-4 mb-2">How AX helps</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Create a repeatable “<strong>MCP Server Intake</strong>” workflow in AX (template) that captures ownership, risk tier, and approval status.</li>
          <li>Use an AX workspace as the <strong>source of truth</strong> for the registry: server onboarding tasks, discussions, decisions, and exceptions live together for later audit and incident review.</li>
        </ul>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>2) Treat every tool call like a privileged operation (least privilege + separation)</CardTitle>
    </CardHeader>
    <CardContent>
        <p>MCP doesn’t remove the need for classic access control—it makes it more urgent. The goal is to keep each agent/tool interaction <strong>narrowly scoped</strong> and <strong>auditable</strong>.</p>
        <h4 className="font-semibold text-foreground mb-2">What to do</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Use <strong>separate identities</strong> for humans vs agents (service accounts per agent or per workflow).</li>
          <li>Prefer <strong>short-lived, scoped credentials</strong> over long-lived secrets.</li>
          <li>Apply <strong>per-tool authorization</strong> (read-only by default; explicit grants for write tools).</li>
          <li>Add <strong>step-up controls</strong> for sensitive operations (extra approvals, additional auth, or constrained modes).</li>
        </ul>
        <h4 className="font-semibold text-foreground mt-4 mb-2">How AX helps</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Model your “agent roles” as explicit AX operational roles (e.g., <em>Build Agent</em>, <em>Ticketing Agent</em>, <em>Prod Change Agent</em>) and tie each role to a minimal tool set.</li>
          <li>Build “<strong>permission boundary</strong>” checklists into AX runbooks so new workspaces inherit sane defaults instead of reinventing controls each time.</li>
        </ul>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>3) Defend against prompt injection and unsafe tool output (OWASP-informed)</CardTitle>
    </CardHeader>
    <CardContent>
        <p>Two failure modes show up repeatedly in agent/tool systems:</p>
        <ol className="list-decimal list-inside space-y-2 my-4">
            <li><strong>Prompt Injection</strong>: untrusted text convinces the agent to do something it shouldn’t.</li>
            <li><strong>Insecure Output Handling</strong>: the model’s output is treated as executable or trusted without validation.</li>
        </ol>
        <p>Both are emphasized by OWASP’s Top 10 for LLM Applications.</p>
        <h4 className="font-semibold text-foreground mb-2">What to do</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Treat <strong>all external content</strong> (issues, emails, web pages, docs, tickets) as <strong>untrusted input</strong>.</li>
          <li>Use <strong>strict tool schemas</strong> and validate arguments (types, ranges, allowed values).</li>
          <li>Require <strong>output validation</strong> before downstream execution (e.g., when output becomes code, SQL, shell, IAM policy, deployment config).</li>
          <li>Keep <strong>system/tool instructions isolated</strong> from user-provided context; avoid concatenating raw user content into tool command strings.</li>
        </ul>
        <h4 className="font-semibold text-foreground mt-4 mb-2">How AX helps</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Make “<strong>plan then act</strong>” the default: agents post a short execution plan in the AX workspace, then call tools only after checks pass.</li>
          <li>Add validation steps as explicit AX tasks (e.g., “Validate generated Terraform plan,” “Confirm least-privilege IAM diff,” “Approve production change”).</li>
        </ul>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>4) Put guardrails on high-impact actions (human-in-the-loop by design)</CardTitle>
    </CardHeader>
    <CardContent>
        <p>Not every tool call needs manual review, but some absolutely should—especially anything that changes production systems, touches credentials/secrets, deletes data, or triggers irreversible actions.</p>
        <h4 className="font-semibold text-foreground mb-2">What to do</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Add <strong>approval gates</strong> for destructive or high-risk tools.</li>
          <li>Require <strong>previews</strong> (diffs, dry runs, “what will change”) before execution.</li>
          <li>Use <strong>two-person review</strong> for production changes when appropriate.</li>
        </ul>
        <h4 className="font-semibold text-foreground mt-4 mb-2">How AX helps</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Implement approval gates as AX tasks assigned to specific approver roles.</li>
          <li>Store evidence (diff outputs, run logs, approvals) in the same workspace thread for quick incident reconstruction.</li>
        </ul>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>5) Centralize MCP traffic with a gateway (policy, auth, logging, rate limits)</CardTitle>
    </CardHeader>
    <CardContent>
        <p>As MCP usage grows, direct client→server connections become hard to manage. A gateway/proxy gives you a single choke point for authentication/authorization, structured audit logs, rate limiting and concurrency controls, and (optionally) inline content checks.</p>
        <h4 className="font-semibold text-foreground mb-2">What to do</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Front MCP servers with a **gateway/proxy** that enforces:
            <ul className="list-disc list-inside space-y-1 pl-5 mt-1">
                <li>**mTLS or equivalent strong client auth**</li>
                <li>centralized **authorization** decisions</li>
                <li>**audit logs** with user/agent identity + tool + parameters (as appropriate)</li>
                <li>**rate limits / quotas** to prevent abuse and “runaway agents”</li>
            </ul>
          </li>
        </ul>
        <h4 className="font-semibold text-foreground mt-4 mb-2">How AX helps</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
            <li>Use AX workspaces as the operational layer for gateway policy changes, incident triage, and approvals (who changed what policy, why, and when).</li>
        </ul>
        <h3 className="text-xl font-bold mt-6 mb-2">Examples of MCP gateways / proxies (for inspiration)</h3>
        <p>These examples span “enterprise governance gateways” and “transport bridges”:</p>
        <ul className="list-disc list-inside space-y-2 pl-5 mt-4">
            <li><strong>Microsoft MCP Gateway</strong> — reverse proxy + management layer for MCP servers (Kubernetes-oriented).<br/><a href="https://github.com/microsoft/mcp-gateway" target="_blank" rel="noopener noreferrer">https://github.com/microsoft/mcp-gateway</a></li>
            <li><strong>Docker MCP Gateway</strong> — centralized orchestration of containerized MCP servers with security defaults and observability.<br/><a href="https://docs.docker.com/ai/mcp-catalog-and-toolkit/mcp-gateway/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/ai/mcp-catalog-and-toolkit/mcp-gateway/</a></li>
            <li><strong>IBM ContextForge MCP Gateway</strong> — gateway/proxy + registry with discovery, auth, rate limiting, and observability.<br/><a href="https://github.com/IBM/mcp-context-forge" target="_blank" rel="noopener noreferrer">https://github.com/IBM/mcp-context-forge</a></li>
            <li><strong>Lasso Security MCP Gateway</strong> — security-focused intermediary for MCP interactions (governance/monitoring).<br/><a href="https://github.com/lasso-security/mcp-gateway" target="_blank" rel="noopener noreferrer">https://github.com/lasso-security/mcp-gateway</a></li>
            <li><strong>sparfenyuk/mcp-proxy</strong> — transport proxy/bridge between stdio and SSE/StreamableHTTP.<br/><a href="https://github.com/sparfenyuk/mcp-proxy" target="_blank" rel="noopener noreferrer">https://github.com/sparfenyuk/mcp-proxy</a></li>
            <li><strong>SecretiveShell/MCP-Bridge</strong> — OpenAI-API-compatible interface for calling MCP tools (bridge pattern).<br/><a href="https://github.com/SecretiveShell/MCP-Bridge" target="_blank" rel="noopener noreferrer">https://github.com/SecretiveShell/MCP-Bridge</a></li>
        </ul>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>6) Contain blast radius at runtime (sandboxing + egress control + quotas)</CardTitle>
    </CardHeader>
    <CardContent>
        <p>Even with perfect auth, tools fail and servers get compromised. Treat MCP servers as <strong>potentially hostile</strong> and limit what they can touch.</p>
        <h4 className="font-semibold text-foreground mb-2">What to do</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Run MCP servers in <strong>isolated containers</strong> (non-root, no privilege escalation).</li>
          <li>Restrict <strong>network egress</strong> to only what’s required (API allowlists).</li>
          <li>Apply <strong>resource quotas</strong> (CPU/RAM/timeouts) and <strong>concurrency limits</strong>.</li>
          <li>Separate <strong>dev/test/prod</strong> MCP runtimes so experimentation doesn’t bleed into production.</li>
        </ul>
        <h4 className="font-semibold text-foreground mt-4 mb-2">How AX helps</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Turn your runtime requirements into “<strong>deployment checklists</strong>” and enforce them via AX runbooks for each environment.</li>
          <li>Capture exceptions explicitly (who approved bypassing egress restrictions and why).</li>
        </ul>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>7) Make it a lifecycle program, not a one-time hardening pass (NIST AI RMF mindset)</CardTitle>
    </CardHeader>
    <CardContent>
        <p>NIST’s AI Risk Management Framework (AI RMF 1.0) emphasizes continuous risk management across the lifecycle—govern, map, measure, manage—rather than a single checklist.</p>
        <h4 className="font-semibold text-foreground mb-2">What to do</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li><strong>Govern</strong>: define ownership and risk acceptance for agent/tool workflows.</li>
          <li><strong>Map</strong>: document where the agent can pull context from and where it can act.</li>
          <li><strong>Measure</strong>: track incidents, near-misses, and control coverage.</li>
          <li><strong>Manage</strong>: continuously improve controls, rotate credentials, patch servers, and update gateway policies.</li>
        </ul>
        <h4 className="font-semibold text-foreground mt-4 mb-2">How AX helps</h4>
        <ul className="list-disc list-inside space-y-2 pl-5">
          <li>Use AX as the “<strong>operating system</strong>” for continuous improvement: incidents become tasks, postmortems become new controls, and controls become templates that roll out to every workspace.</li>
        </ul>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>Implementation starter pack for AX customers</CardTitle>
    </CardHeader>
    <CardContent>
        <p>If you want a practical starting point, implement these in order:</p>
        <ol className="list-decimal list-inside space-y-2 my-4">
            <li><strong>Registry + allowlists</strong>: approve MCP servers and tools; pin versions/digests.</li>
            <li><strong>Identity boundaries</strong>: agent service accounts; short-lived scoped tokens; per-tool auth.</li>
            <li><strong>Input/output safety</strong>: schema validation; output checks before execution; avoid prompt injection sinks.</li>
            <li><strong>High-risk approvals</strong>: gates + previews for production and destructive operations.</li>
            <li><strong>Gateway standardization</strong>: central auth/logging/rate limits.</li>
            <li><strong>Runtime containment</strong>: containers, egress restrictions, quotas, environment separation.</li>
            <li><strong>Lifecycle metrics</strong>: incident trends, log coverage, onboarding compliance, MTTR for MCP-related fixes.</li>
        </ol>
    </CardContent>
</Card>

<Card>
    <CardHeader>
        <CardTitle>References</CardTitle>
    </CardHeader>
    <CardContent>
        <ul className="list-disc list-inside space-y-2 pl-5">
            <li>OWASP Top 10 for Large Language Model Applications (Prompt Injection, Insecure Output Handling):<br/><a href="https://owasp.org/www-project-top-10-for-large-language-model-applications/" target="_blank" rel="noopener noreferrer">https://owasp.org/www-project-top-10-for-large-language-model-applications/</a></li>
            <li>OWASP LLM Prompt Injection Prevention Cheat Sheet:<br/><a href="https://cheatsheetseries.owasp.org/cheatsheets/LLM_Prompt_Injection_Prevention_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">https://cheatsheetseries.owasp.org/cheatsheets/LLM_Prompt_Injection_Prevention_Cheat_Sheet.html</a></li>
            <li>NIST AI Risk Management Framework (AI RMF 1.0):<br/><a href="https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf" target="_blank" rel="noopener noreferrer">https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf</a></li>
            <li>NIST SP 800-53 (Least Privilege control family reference):<br/><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf" target="_blank" rel="noopener noreferrer">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf</a></li>
        </ul>
    </CardContent>
</Card>
